"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[799],{91799:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var r=n(32735),a=n(60216),s=n.n(a),i=n(31492),l=n(84334),o=n(63677),c=n(21572),u=n(12200),m=n(43418),d=n(19680),p=n(76467);function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}const{formatDate:E}=i.default;function g(e){const{displaySets:t,viewportIndex:n,viewportLabel:a,servicesManager:s,extensionManager:i,viewportOptions:g}=e,{t:v}=(0,c.$G)("TrackedViewport"),{measurementService:b,cornerstoneViewportService:S}=s.services,w=t[0],[h]=(0,m.I)(),[x,I]=(0,r.useState)(!1),[y,N]=(0,r.useState)(null),[k,D]=(0,r.useState)(null),{trackedSeries:V}=h.context,O=g.viewportId,{SeriesDate:M,SeriesDescription:T,SeriesInstanceUID:P,SeriesNumber:C}=w,{PatientID:R,PatientName:U,PatientSex:_,PatientAge:j,SliceThickness:A,SpacingBetweenSlices:F,ManufacturerModelName:L}=w.images[0],W=(0,r.useCallback)((()=>{const e=S.getCornerstoneViewportByIndex(n);if(e instanceof d.Z){const t=e?.getCurrentImageId();if(!t)return void(x&&I(!1))}V.includes(P)!==x&&I(!x)}),[x,h,n,P]),Z=(0,r.useCallback)((e=>{e.detail.element!==k&&(e.detail.element?.addEventListener(p.default.VOLUME_VIEWPORT_NEW_VOLUME,W),D(e.detail.element))}),[W,k]),q=(0,r.useCallback)((()=>{k?.removeEventListener(p.default.VOLUME_VIEWPORT_NEW_VOLUME,W)}),[W,k]);(0,r.useEffect)(W,[W]),(0,r.useEffect)((()=>{const{unsubscribe:e}=S.subscribe(S.EVENTS.VIEWPORT_DATA_CHANGED,(e=>{e.viewportIndex===n&&W()}));return()=>{e()}}),[W,n]),(0,r.useEffect)((()=>x?(u.Z.setViewportToolStyles(O,{global:{lineDash:""}}),void S.getRenderingEngine().renderViewport(O)):(u.Z.setViewportToolStyles(O,{global:{lineDash:"4,4"}}),S.getRenderingEngine().renderViewport(O),()=>{u.Z.setViewportToolStyles(O,{})})),[x]);return r.createElement(r.Fragment,null,r.createElement(o.uY,{onDoubleClick:e=>{e.stopPropagation(),e.preventDefault()},useAltStyling:x,onArrowsClick:e=>function(e){const t=function(e,t,n,r){const{measurementService:a,viewportGridService:s}=t.services,i=a.getMeasurements(),{activeViewportIndex:l,viewports:o}=s.getState(),{displaySetInstanceUIDs:c}=o[l],{trackedSeries:u}=r.context,m=i.filter((e=>u.includes(e.referenceSeriesUID)&&c.includes(e.displaySetInstanceUID)));if(!m.length)return;const d=m.length,p=m.map((e=>e.uid));let f=p.findIndex((e=>e===n));return-1===f?f=0:"left"===e?(f--,f<0&&(f=d-1)):"right"===e&&(f++,f===d&&(f=0)),p[f]}(e,s,y,h);t&&(N(t),b.jumpToMeasurement(n,t))}(e),getStatusComponent:()=>function(e){const t=e?"status-tracked":"status-untracked";return r.createElement("div",{className:"relative"},r.createElement(o.u,{position:"bottom-left",content:r.createElement("div",{className:"flex py-2"},r.createElement("div",{className:"flex pt-1"},r.createElement(o.JO,{name:"info-link",className:"w-4 text-primary-main"})),r.createElement("div",{className:"flex ml-4"},r.createElement("span",{className:"text-base text-common-light"},e?r.createElement(r.Fragment,null,"Series is",r.createElement("span",{className:"font-bold text-white"}," tracked")," and can be viewed ",r.createElement("br",null)," in the measurement panel"):r.createElement(r.Fragment,null,"Measurements for",r.createElement("span",{className:"font-bold text-white"}," untracked "),"series ",r.createElement("br",null)," will not be shown in the ",r.createElement("br",null)," measurements panel"))))},r.createElement(o.JO,{name:t,className:"text-primary-light"})))}(x),studyData:{label:a,studyDate:E(M),currentSeries:C,seriesDescription:T,patientInformation:{patientName:U?l.default.utils.formatPN(U):"",patientSex:_||"",patientAge:j||"",MRN:R||"",thickness:A?`${parseFloat(A).toFixed(2)}mm`:"",spacing:void 0!==F?`${parseFloat(F).toFixed(2)}mm`:"",scanner:L||""}}}),r.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(()=>{const{component:t}=i.getModuleEntry("@ohif/extension-cornerstone.viewportModule.cornerstone");return r.createElement(t,f({},e,{onElementEnabled:Z,onElementDisabled:q}))})()))}g.propTypes={displaySets:s().arrayOf(s().object.isRequired).isRequired,viewportIndex:s().number.isRequired,dataSource:s().object,children:s().node,customProps:s().object},g.defaultProps={customProps:{}};const v=g}}]);
//# sourceMappingURL=799.bundle.fc28080fe9b141f7432d.js.map